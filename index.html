<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>å‰µæ™ºå‹•èƒ½ 2026 åŸå¸‚å»ºè¨­ - å°¾ç‰™äº’å‹•éŠæˆ²</title>
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ™ï¸</text></svg>">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700;900&display=swap');

    :root {
      /* å¡é€šå¯æ„›é¢¨é…è‰² - èˆ‡æŠ•å½±ä»‹é¢ä¸€è‡´ */
      --primary: #FF6B9D;
      --primary-dark: #E85A8A;
      --secondary: #FFD93D;
      --success: #6BCB77;
      --danger: #FF6B6B;
      --warning: #FFD93D;
      --info: #4D96FF;
      --purple: #C86BFA;
      --bg: linear-gradient(180deg, #4FC3F7 0%, #81D4FA 30%, #B3E5FC 50%, #E1F5FE 70%);
      --bg-solid: #E1F5FE;
      --bg-card: rgba(255, 255, 255, 0.95);
      --bg-hover: rgba(255, 255, 255, 1);
      --text: #4A4A4A;
      --text-muted: #777777;
      --border: #E0E0E0;
      --shadow: rgba(0,0,0,0.1);
    }

    body {
      font-family: 'Noto Sans TC', 'Microsoft JhengHei', -apple-system, BlinkMacSystemFont, sans-serif;
      background: var(--bg);
      color: var(--text);
      min-height: 100vh;
      overflow-x: hidden;
    }

    /* ===== è¼‰å…¥ç•«é¢ ===== */
    #loading-screen {
      position: fixed;
      inset: 0;
      background: var(--bg);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      z-index: 1000;
    }

    .loading-spinner {
      width: 60px;
      height: 60px;
      border: 4px solid rgba(255,255,255,0.5);
      border-top-color: var(--primary);
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }

    #loading-screen p {
      color: var(--text);
      font-weight: 600;
      text-shadow: 1px 1px 2px rgba(255,255,255,0.5);
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    /* ===== åŠ å…¥éŠæˆ²ç•«é¢ ===== */
    #join-screen {
      display: none;
      min-height: 100vh;
      padding: 20px;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }

    .join-wrapper {
      width: 100%;
      max-width: 400px;
      text-align: center;
      position: relative;
    }

    .company-logo {
      width: 180px;
      height: auto;
      margin: 0 auto 30px;
      filter: drop-shadow(2px 4px 8px rgba(0,0,0,0.2));
    }

    .game-logo {
      font-size: 4rem;
      margin-bottom: -30px;
      filter: drop-shadow(2px 4px 6px rgba(0,0,0,0.15));
      position: relative;
      z-index: 2;
    }

    .join-container {
      background: var(--bg-card);
      padding: 50px 30px 30px;
      border-radius: 24px;
      box-shadow: 0 8px 32px var(--shadow);
      position: relative;
      z-index: 1;
    }

    .game-title {
      font-size: 1.5rem;
      font-weight: 900;
      margin-bottom: 8px;
      color: var(--text);
    }

    .game-subtitle {
      color: var(--text-muted);
      margin-bottom: 30px;
      font-weight: 500;
      font-size: 0.95rem;
    }

    .input-group {
      margin-bottom: 15px;
    }

    .input-group label {
      display: block;
      text-align: left;
      margin-bottom: 5px;
      font-size: 0.9rem;
      color: var(--text-muted);
      font-weight: 600;
    }

    .input-group input {
      width: 100%;
      padding: 15px;
      border: 2px solid var(--border);
      border-radius: 12px;
      background: #FFFFFF;
      color: var(--text);
      font-size: 1rem;
      transition: all 0.2s;
      box-shadow: inset 0 2px 4px rgba(0,0,0,0.05);
    }

    .input-group input:focus {
      outline: none;
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(255, 107, 157, 0.2);
    }

    .input-group input::placeholder {
      color: #AAAAAA;
    }

    .btn {
      width: 100%;
      padding: 15px;
      border: none;
      border-radius: 12px;
      font-size: 1.1rem;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.2s;
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    }

    .btn-primary {
      background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
      color: white;
    }

    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 16px rgba(255, 107, 157, 0.4);
    }

    .btn-primary:active {
      transform: translateY(0);
    }

    .btn-primary:disabled {
      background: var(--border);
      cursor: not-allowed;
      box-shadow: none;
    }

    /* ===== éŠæˆ²ä¸»ç•«é¢ ===== */
    #game-screen {
      display: none;
      min-height: 100vh;
      padding-bottom: 20px;
    }

    /* é ‚éƒ¨ç‹€æ…‹æ¬„ */
    .game-header {
      background: var(--bg-card);
      padding: 15px 20px;
      border-bottom: 2px solid var(--border);
      position: sticky;
      top: 0;
      z-index: 100;
      box-shadow: 0 2px 12px var(--shadow);
    }

    .header-top {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
    }

    .player-name-display {
      font-weight: 700;
      font-size: 1.1rem;
      color: var(--text);
    }

    /* å³ä¸Šè§’è§’è‰²é¡¯ç¤º */
    .header-role-badge {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 6px 12px;
      border-radius: 20px;
      border: 2px solid;
      font-size: 0.85rem;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.2s;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    }

    .header-role-badge:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0,0,0,0.2);
    }

    .header-role-emoji {
      font-size: 1.2rem;
    }

    .header-role-name {
      font-size: 0.9rem;
    }

    .game-state {
      display: inline-block;
      padding: 5px 12px;
      border-radius: 20px;
      font-size: 0.8rem;
      font-weight: bold;
      color: white;
    }

    .game-state.WAITING { background: #2196F3; }
    .game-state.BUILDING { background: #4CAF50; }
    .game-state.EVENT { background: #FF9800; color: #fff; }
    .game-state.ENDED { background: #E91E63; }

    /* è³‡æºåˆ— */
    .resources {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 10px;
    }

    .resource-item {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      padding: 10px;
      background: rgba(255,255,255,0.6);
      border-radius: 12px;
      border: 2px solid var(--border);
    }

    .resource-icon {
      font-size: 1.3rem;
    }

    .resource-value {
      font-weight: 900;
      font-size: 1.2rem;
      color: var(--text);
    }

    .resource-label {
      font-size: 0.75rem;
      color: var(--text-muted);
      font-weight: 500;
    }

    /* ä¸»è¦å…§å®¹å€ */
    .game-content {
      padding: 20px;
    }

    /* ç­‰å¾…ç•«é¢ */
    .waiting-screen {
      display: none;
      text-align: center;
      padding: 40px 20px;
    }

    .waiting-screen.show {
      display: block;
    }

    .waiting-emoji {
      font-size: 4rem;
      margin-bottom: 20px;
      animation: bounce 2s ease-in-out infinite;
    }

    @keyframes bounce {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-10px); }
    }

    .waiting-text {
      font-size: 1.2rem;
      margin-bottom: 10px;
      font-weight: 600;
      color: var(--text);
    }

    .player-count {
      color: var(--text-muted);
      font-weight: 500;
    }

    /* äº‹ä»¶é¡¯ç¤ºå€ */
    .event-display {
      display: none;
      background: linear-gradient(135deg, var(--bg-card) 0%, rgba(255, 107, 157, 0.1) 100%);
      border: 3px solid var(--primary);
      border-radius: 20px;
      padding: 20px;
      margin-bottom: 20px;
      text-align: center;
      box-shadow: 0 4px 16px rgba(255, 107, 157, 0.2);
    }

    .event-display.show {
      display: block;
      animation: fadeIn 0.5s;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .event-emoji {
      font-size: 3rem;
      margin-bottom: 10px;
    }

    .event-title {
      font-size: 1.3rem;
      font-weight: bold;
      margin-bottom: 10px;
    }

    .event-description {
      color: var(--text-muted);
      margin-bottom: 15px;
      line-height: 1.5;
    }

    .event-effects {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 8px;
    }

    .effect-tag {
      padding: 5px 12px;
      border-radius: 20px;
      font-size: 0.85rem;
      font-weight: bold;
    }

    .effect-tag.positive {
      background: rgba(107, 203, 119, 0.2);
      color: #4CAF50;
    }

    .effect-tag.negative {
      background: rgba(255, 107, 107, 0.2);
      color: #FF6B6B;
    }

    .income-result {
      margin-top: 15px;
      padding: 15px;
      background: rgba(255,255,255,0.8);
      border-radius: 12px;
      border: 2px solid var(--border);
    }

    .income-amount {
      font-size: 1.5rem;
      font-weight: 900;
      color: var(--success);
    }

    .effect-hint {
      width: 100%;
      margin-top: 8px;
      font-size: 0.75rem;
      color: var(--text-muted);
    }

    .event-close-btn {
      position: absolute;
      top: 10px;
      right: 10px;
      background: rgba(255,255,255,0.9);
      border: 2px solid var(--border);
      color: var(--text-muted);
      width: 28px;
      height: 28px;
      border-radius: 50%;
      cursor: pointer;
      font-size: 1rem;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s;
    }

    .event-close-btn:hover {
      background: var(--danger);
      color: white;
      border-color: var(--danger);
    }

    .event-dismiss-hint {
      margin-top: 10px;
      font-size: 0.75rem;
      color: var(--text-muted);
      cursor: pointer;
    }

    .event-dismiss-hint:hover {
      color: var(--primary);
    }

    /* å»ºç¯‰é¸æ“‡å€ */
    .building-section {
      margin-bottom: 20px;
    }

    .section-title {
      font-size: 1rem;
      margin-bottom: 15px;
      color: var(--text);
      font-weight: 700;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    /* åˆ†é¡æ¨™ç±¤ */
    .category-tabs {
      display: flex;
      gap: 8px;
      margin-bottom: 15px;
      overflow-x: auto;
      padding-bottom: 5px;
    }

    .category-tab {
      padding: 8px 16px;
      border: 2px solid var(--border);
      border-radius: 20px;
      background: rgba(255,255,255,0.9);
      color: var(--text-muted);
      font-size: 0.85rem;
      font-weight: 600;
      cursor: pointer;
      white-space: nowrap;
      transition: all 0.2s;
    }

    .category-tab:hover {
      border-color: var(--primary);
      color: var(--primary);
    }

    .category-tab.active {
      background: var(--primary);
      border-color: var(--primary);
      color: white;
      box-shadow: 0 3px 10px rgba(255, 107, 157, 0.3);
    }

    .building-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 12px;
    }

    .building-card {
      background: var(--bg-card);
      border: 2px solid var(--border);
      border-radius: 16px;
      padding: 15px;
      cursor: pointer;
      transition: all 0.2s;
      box-shadow: 0 2px 8px var(--shadow);
    }

    .building-card:hover {
      border-color: var(--primary);
      transform: translateY(-3px);
      box-shadow: 0 6px 16px rgba(255, 107, 157, 0.2);
    }

    .building-card.disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    .building-card.disabled:hover {
      transform: none;
      border-color: var(--border);
      box-shadow: 0 2px 8px var(--shadow);
    }

    .building-header {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 10px;
    }

    .building-emoji {
      font-size: 2rem;
    }

    .building-info {
      flex: 1;
    }

    .building-name {
      font-weight: 700;
      font-size: 0.95rem;
      color: var(--text);
    }

    .building-category {
      font-size: 0.7rem;
      color: var(--text-muted);
      font-weight: 500;
    }

    .building-stats {
      display: flex;
      justify-content: space-between;
      font-size: 0.85rem;
      font-weight: 600;
    }

    .building-cost {
      color: #FF9800;
    }

    .building-income {
      color: #4CAF50;
    }

    /* æˆ‘çš„å»ºç¯‰ */
    .my-buildings {
      background: var(--bg-card);
      border-radius: 20px;
      padding: 15px;
      margin-bottom: 20px;
      box-shadow: 0 2px 12px var(--shadow);
    }

    .my-buildings-title {
      font-weight: 700;
      margin-bottom: 10px;
      display: flex;
      align-items: center;
      gap: 8px;
      color: var(--text);
    }

    .my-buildings-grid {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
    }

    .my-building-item {
      display: flex;
      align-items: center;
      gap: 5px;
      background: rgba(255,255,255,0.8);
      padding: 6px 12px;
      border-radius: 10px;
      font-size: 0.9rem;
      border: 2px solid var(--border);
    }

    .my-building-count {
      background: var(--primary);
      color: white;
      width: 20px;
      height: 20px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.75rem;
      font-weight: bold;
    }

    .no-buildings {
      color: var(--text-muted);
      text-align: center;
      padding: 10px;
      font-weight: 500;
    }

    /* è§’è‰²é¡¯ç¤º Modal */
    #role-modal {
      display: none;
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.5);
      z-index: 300;
      padding: 20px;
      overflow-y: auto;
      backdrop-filter: blur(4px);
      align-items: center;
      justify-content: center;
    }

    #role-modal.show {
      display: flex;
    }

    .role-modal-content {
      background: var(--bg-card);
      border-radius: 24px;
      max-width: 400px;
      width: 100%;
      padding: 25px;
      box-shadow: 0 8px 32px rgba(0,0,0,0.2);
      text-align: center;
    }

    .role-modal-close {
      position: absolute;
      top: 15px;
      right: 15px;
      background: none;
      border: none;
      color: var(--text-muted);
      font-size: 1.5rem;
      cursor: pointer;
    }

    .role-badge {
      display: inline-flex;
      align-items: center;
      gap: 10px;
      padding: 12px 24px;
      border-radius: 24px;
      border: 3px solid;
      margin-bottom: 15px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    }

    .role-emoji {
      font-size: 2.5rem;
    }

    .role-name {
      font-weight: bold;
      font-size: 1.3rem;
    }

    .role-skill {
      font-size: 1rem;
      color: var(--text-muted);
      line-height: 1.6;
      text-align: left;
      padding: 15px;
      background: rgba(255,255,255,0.6);
      border-radius: 12px;
      border: 2px solid var(--border);
    }

    /* æ’è¡Œæ¦œ - éš±è— */
    .leaderboard {
      display: none;
      background: var(--bg-card);
      border-radius: 20px;
      padding: 15px;
      box-shadow: 0 2px 12px var(--shadow);
    }

    .leaderboard-title {
      font-weight: 700;
      margin-bottom: 10px;
      display: flex;
      align-items: center;
      gap: 8px;
      color: var(--text);
    }

    .leaderboard-list {
      list-style: none;
    }

    .leaderboard-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 10px;
      border-bottom: 1px solid var(--border);
    }

    .leaderboard-item:last-child {
      border-bottom: none;
    }

    .leaderboard-item.is-me {
      background: rgba(255, 107, 157, 0.15);
      border-radius: 10px;
      border: 2px solid var(--primary);
    }

    .leaderboard-rank {
      width: 30px;
      font-weight: 900;
    }

    .leaderboard-rank.top-1 { color: #ffd700; text-shadow: 0 0 10px rgba(255,215,0,0.5); }
    .leaderboard-rank.top-2 { color: #c0c0c0; text-shadow: 0 0 10px rgba(192,192,192,0.5); }
    .leaderboard-rank.top-3 { color: #cd7f32; text-shadow: 0 0 10px rgba(205,127,50,0.5); }

    .leaderboard-name {
      flex: 1;
      font-weight: 600;
    }

    .leaderboard-info {
      display: flex;
      align-items: center;
      gap: 15px;
    }

    .leaderboard-buildings {
      font-size: 0.85rem;
      color: var(--text-muted);
    }

    .leaderboard-score {
      font-weight: 900;
      color: var(--primary);
    }

    /* çµæœç•«é¢ */
    .result-screen {
      display: none;
      padding: 20px;
    }

    .result-screen.show {
      display: block;
    }

    .result-card {
      background: var(--bg-card);
      border-radius: 16px;
      padding: 20px;
      text-align: center;
      margin-bottom: 20px;
    }

    .result-score {
      font-size: 3rem;
      font-weight: bold;
      color: var(--primary);
    }

    .result-label {
      color: var(--text-muted);
      margin-bottom: 10px;
    }

    /* Toast æç¤º */
    .toast {
      position: fixed;
      top: 80px;
      left: 50%;
      transform: translateX(-50%);
      padding: 12px 24px;
      border-radius: 12px;
      z-index: 1000;
      animation: toastIn 0.3s ease-out;
      font-weight: 600;
      box-shadow: 0 4px 16px rgba(0,0,0,0.2);
    }

    .toast.success {
      background: var(--success);
      color: white;
    }

    .toast.error {
      background: var(--danger);
      color: white;
    }

    .toast.info {
      background: var(--info);
      color: white;
    }

    @keyframes toastIn {
      from {
        opacity: 0;
        transform: translate(-50%, -20px);
      }
      to {
        opacity: 1;
        transform: translate(-50%, 0);
      }
    }

    @keyframes toastOut {
      from {
        opacity: 1;
        transform: translate(-50%, 0);
      }
      to {
        opacity: 0;
        transform: translate(-50%, -20px);
      }
    }

    @keyframes pulse {
      0%, 100% {
        opacity: 1;
        transform: scale(1);
      }
      50% {
        opacity: 0.6;
        transform: scale(1.05);
      }
    }

    /* è³¼è²·ç¢ºèªå½ˆçª— */
    .modal-overlay {
      display: none;
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.5);
      z-index: 200;
      align-items: center;
      justify-content: center;
      padding: 20px;
      backdrop-filter: blur(4px);
    }

    .modal-overlay.show {
      display: flex;
    }

    .modal {
      background: var(--bg-card);
      border-radius: 24px;
      padding: 25px;
      width: 100%;
      max-width: 350px;
      text-align: center;
      box-shadow: 0 8px 32px rgba(0,0,0,0.2);
    }

    .modal-emoji {
      font-size: 3rem;
      margin-bottom: 10px;
    }

    .modal-title {
      font-size: 1.3rem;
      font-weight: bold;
      margin-bottom: 15px;
    }

    .modal-info {
      background: rgba(255,255,255,0.6);
      border-radius: 12px;
      padding: 15px;
      margin-bottom: 20px;
      border: 2px solid var(--border);
    }

    .modal-info-row {
      display: flex;
      justify-content: space-between;
      margin-bottom: 8px;
    }

    .modal-info-row:last-child {
      margin-bottom: 0;
    }

    .modal-buttons {
      display: flex;
      gap: 10px;
    }

    .modal-btn {
      flex: 1;
      padding: 12px;
      border: none;
      border-radius: 12px;
      font-size: 1rem;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.2s;
    }

    .modal-btn.cancel {
      background: var(--border);
      color: var(--text);
    }

    .modal-btn.cancel:hover {
      background: #CCCCCC;
    }

    .modal-btn.confirm {
      background: linear-gradient(135deg, var(--success) 0%, #4CAF50 100%);
      color: white;
      box-shadow: 0 4px 12px rgba(107, 203, 119, 0.3);
    }

    .modal-btn.confirm:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 16px rgba(107, 203, 119, 0.4);
    }

    /* ===== æˆå°±ç³»çµ± ===== */

    /* æˆå°±æŒ‰éˆ• */
    .achievements-btn {
      position: fixed;
      bottom: 20px;
      right: 20px;
      width: 56px;
      height: 56px;
      border-radius: 50%;
      background: linear-gradient(135deg, var(--secondary) 0%, #FFC107 100%);
      border: 3px solid white;
      font-size: 1.5rem;
      cursor: pointer;
      box-shadow: 0 4px 16px rgba(255, 217, 61, 0.5);
      z-index: 50;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s;
    }

    .achievements-btn:hover {
      transform: scale(1.1);
      box-shadow: 0 6px 20px rgba(255, 217, 61, 0.6);
    }

    .achievements-btn .badge {
      position: absolute;
      top: -5px;
      right: -10px;
      background: var(--danger);
      color: white;
      min-width: 22px;
      height: 20px;
      border-radius: 10px;
      font-size: 0.65rem;
      font-weight: bold;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 0 5px;
    }

    /* æˆå°±è§£é–å½ˆå‡ºå‹•ç•« */
    .achievement-popup {
      position: fixed;
      top: 100px;
      left: 50%;
      transform: translateX(-50%);
      z-index: 1001;
      animation: achievementSlideIn 0.5s ease-out;
    }

    .achievement-popup.fade-out {
      animation: achievementSlideOut 0.5s ease-in forwards;
    }

    @keyframes achievementSlideIn {
      from {
        opacity: 0;
        transform: translate(-50%, -30px) scale(0.9);
      }
      to {
        opacity: 1;
        transform: translate(-50%, 0) scale(1);
      }
    }

    @keyframes achievementSlideOut {
      from {
        opacity: 1;
        transform: translate(-50%, 0) scale(1);
      }
      to {
        opacity: 0;
        transform: translate(-50%, -30px) scale(0.9);
      }
    }

    .achievement-popup-content {
      display: flex;
      align-items: center;
      gap: 15px;
      background: linear-gradient(135deg, var(--bg-card) 0%, rgba(255, 217, 61, 0.2) 100%);
      border: 3px solid var(--secondary);
      border-radius: 20px;
      padding: 15px 20px;
      box-shadow: 0 8px 32px rgba(255, 217, 61, 0.3);
      max-width: 350px;
    }

    .achievement-popup-icon {
      font-size: 2.5rem;
      animation: achievementBounce 0.6s ease-in-out;
    }

    @keyframes achievementBounce {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.2); }
    }

    .achievement-popup-info {
      flex: 1;
    }

    .achievement-popup-label {
      font-size: 0.8rem;
      color: #FF9800;
      font-weight: bold;
      margin-bottom: 4px;
    }

    .achievement-popup-name {
      font-size: 1.1rem;
      font-weight: bold;
      margin-bottom: 4px;
    }

    .achievement-popup-desc {
      font-size: 0.85rem;
      color: var(--text-muted);
      margin-bottom: 6px;
    }

    .achievement-popup-reward {
      display: flex;
      gap: 10px;
      font-size: 0.9rem;
      font-weight: bold;
      color: var(--success);
    }

    /* æˆå°±åˆ—è¡¨ Modal */
    #achievements-modal {
      display: none;
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.5);
      z-index: 300;
      padding: 20px;
      overflow-y: auto;
      backdrop-filter: blur(4px);
    }

    #achievements-modal.show {
      display: block;
    }

    .achievements-modal-content {
      background: var(--bg-card);
      border-radius: 24px;
      max-width: 500px;
      margin: 0 auto;
      padding: 20px;
      box-shadow: 0 8px 32px rgba(0,0,0,0.2);
    }

    .achievements-modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }

    .achievements-modal-title {
      font-size: 1.3rem;
      font-weight: bold;
    }

    .achievements-modal-close {
      background: none;
      border: none;
      color: var(--text-muted);
      font-size: 1.5rem;
      cursor: pointer;
    }

    .achievement-category {
      margin-bottom: 25px;
    }

    .achievement-category h4 {
      font-size: 1rem;
      margin-bottom: 12px;
      color: var(--text-muted);
      border-bottom: 1px solid var(--border);
      padding-bottom: 8px;
    }

    .achievement-items {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .achievement-item {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 12px;
      background: rgba(255,255,255,0.6);
      border-radius: 12px;
      border: 2px solid var(--border);
      opacity: 0.6;
    }

    .achievement-item.unlocked {
      opacity: 1;
      border-color: var(--success);
      background: rgba(107, 203, 119, 0.15);
    }

    .achievement-item.claimed {
      opacity: 0.4;
    }

    .achievement-icon {
      font-size: 1.8rem;
      width: 40px;
      text-align: center;
    }

    .achievement-info {
      flex: 1;
    }

    .achievement-name {
      font-weight: bold;
      font-size: 0.95rem;
      margin-bottom: 3px;
    }

    .achievement-desc {
      font-size: 0.8rem;
      color: var(--text-muted);
    }

    .achievement-claimed-by {
      font-size: 0.75rem;
      color: var(--danger);
      margin-top: 4px;
    }

    .achievement-reward {
      text-align: right;
      font-size: 0.85rem;
      color: var(--success);
      font-weight: bold;
    }

    /* ===== é“å…·ç³»çµ± ===== */

    /* é“å…·æŒ‰éˆ•çµ„ */
    .item-buttons {
      position: fixed;
      bottom: 20px;
      left: 20px;
      display: flex;
      flex-direction: column;
      gap: 10px;
      z-index: 50;
    }

    .item-btn {
      position: relative;
      width: 50px;
      height: 50px;
      border-radius: 50%;
      border: none;
      font-size: 1.3rem;
      cursor: pointer;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
      display: flex;
      align-items: center;
      justify-content: center;
      transition: transform 0.2s;
    }

    .item-btn:hover {
      transform: scale(1.1);
    }

    .item-btn.shop {
      background: linear-gradient(135deg, #FF9800 0%, #F57C00 100%);
      border: 3px solid white;
    }

    .item-btn.backpack {
      background: linear-gradient(135deg, var(--info) 0%, #2196F3 100%);
      border: 3px solid white;
    }

    .item-btn .badge {
      position: absolute;
      top: -5px;
      right: -5px;
      background: var(--danger);
      color: white;
      min-width: 18px;
      height: 18px;
      border-radius: 9px;
      font-size: 0.7rem;
      font-weight: bold;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 0 4px;
    }

    /* é“å…·æ‰è½å½ˆå‡º */
    .item-drop-popup {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      z-index: 1002;
      animation: itemDropIn 0.5s ease-out;
    }

    .item-drop-popup.fade-out {
      animation: itemDropOut 0.5s ease-in forwards;
    }

    @keyframes itemDropIn {
      from {
        opacity: 0;
        transform: translate(-50%, -50%) scale(0.5);
      }
      to {
        opacity: 1;
        transform: translate(-50%, -50%) scale(1);
      }
    }

    @keyframes itemDropOut {
      from {
        opacity: 1;
        transform: translate(-50%, -50%) scale(1);
      }
      to {
        opacity: 0;
        transform: translate(-50%, -50%) scale(0.5);
      }
    }

    .item-drop-content {
      background: linear-gradient(135deg, var(--bg-card) 0%, rgba(255, 217, 61, 0.2) 100%);
      border: 3px solid var(--secondary);
      border-radius: 24px;
      padding: 30px 40px;
      text-align: center;
      box-shadow: 0 0 40px rgba(255, 217, 61, 0.4);
    }

    .item-drop-label {
      font-size: 0.9rem;
      color: var(--warning);
      font-weight: bold;
      margin-bottom: 10px;
    }

    .item-drop-icon {
      font-size: 4rem;
      animation: itemBounce 0.6s ease-in-out;
    }

    @keyframes itemBounce {
      0%, 100% { transform: scale(1) rotate(0deg); }
      25% { transform: scale(1.2) rotate(-10deg); }
      50% { transform: scale(1.1) rotate(10deg); }
      75% { transform: scale(1.15) rotate(-5deg); }
    }

    .item-drop-name {
      font-size: 1.3rem;
      font-weight: bold;
      margin: 10px 0 5px;
    }

    .item-drop-desc {
      font-size: 0.9rem;
      color: var(--text-muted);
    }

    /* é“å…·å•†åº— Modal */
    #item-shop-modal, #my-items-modal {
      display: none;
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.5);
      z-index: 300;
      padding: 20px;
      overflow-y: auto;
      backdrop-filter: blur(4px);
    }

    #item-shop-modal.show, #my-items-modal.show {
      display: block;
    }

    .item-modal-content {
      background: var(--bg-card);
      border-radius: 24px;
      max-width: 500px;
      margin: 0 auto;
      padding: 20px;
      box-shadow: 0 8px 32px rgba(0,0,0,0.2);
    }

    .item-modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }

    .item-modal-title {
      font-size: 1.3rem;
      font-weight: bold;
    }

    .item-modal-close {
      background: none;
      border: none;
      color: var(--text-muted);
      font-size: 1.5rem;
      cursor: pointer;
    }

    .item-modal-coins {
      font-size: 1rem;
      color: var(--warning);
    }

    /* é“å…·å•†åº—å¡ç‰‡ */
    .item-shop-card {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 15px;
      background: rgba(255,255,255,0.6);
      border-radius: 16px;
      margin-bottom: 10px;
      cursor: pointer;
      transition: all 0.2s;
      border: 2px solid var(--border);
    }

    .item-shop-card:hover {
      border-color: var(--primary);
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(255, 107, 157, 0.2);
    }

    .item-shop-card.disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    .item-shop-card.disabled:hover {
      border-color: var(--border);
      transform: none;
      box-shadow: none;
    }

    .item-shop-icon {
      font-size: 2rem;
      width: 50px;
      text-align: center;
    }

    .item-shop-info {
      flex: 1;
    }

    .item-shop-name {
      font-weight: bold;
      margin-bottom: 4px;
    }

    .item-shop-desc {
      font-size: 0.8rem;
      color: var(--text-muted);
    }

    .item-shop-cost {
      font-weight: bold;
      color: var(--warning);
    }

    /* æˆ‘çš„é“å…· */
    .my-item-card {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 15px;
      background: rgba(255,255,255,0.6);
      border-radius: 16px;
      margin-bottom: 10px;
      border: 2px solid var(--border);
    }

    .my-item-icon {
      font-size: 2rem;
      width: 50px;
      text-align: center;
    }

    .my-item-info {
      flex: 1;
    }

    .my-item-name {
      font-weight: bold;
      margin-bottom: 4px;
    }

    .my-item-desc {
      font-size: 0.8rem;
      color: var(--text-muted);
    }

    .my-item-use-btn {
      padding: 8px 16px;
      background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
      border: none;
      border-radius: 10px;
      color: white;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.2s;
      box-shadow: 0 2px 8px rgba(255, 107, 157, 0.3);
    }

    .my-item-use-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(255, 107, 157, 0.4);
    }

    .no-items {
      text-align: center;
      color: var(--text-muted);
      padding: 30px;
    }

    .active-effects-section {
      margin-top: 20px;
      padding-top: 15px;
      border-top: 1px solid var(--border);
    }

    .active-effects-section h4 {
      color: var(--success);
      margin-bottom: 10px;
    }

    .active-effect-item {
      display: flex;
      justify-content: space-between;
      padding: 8px 12px;
      background: rgba(107, 203, 119, 0.15);
      border-radius: 10px;
      margin-bottom: 5px;
      border: 2px solid rgba(107, 203, 119, 0.3);
    }

    .active-effect-source {
      font-weight: bold;
    }

    .active-effect-status {
      color: var(--success);
      font-size: 0.85rem;
    }

    /* ===== å°äº‹ä»¶ç³»çµ± ===== */
    .mini-event-popup {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      z-index: 1003;
      animation: miniEventIn 0.4s ease-out;
    }

    .mini-event-popup.fade-out {
      animation: miniEventOut 0.4s ease-in forwards;
    }

    @keyframes miniEventIn {
      from {
        opacity: 0;
        transform: translate(-50%, -50%) scale(0.8) rotate(-5deg);
      }
      to {
        opacity: 1;
        transform: translate(-50%, -50%) scale(1) rotate(0deg);
      }
    }

    @keyframes miniEventOut {
      from {
        opacity: 1;
        transform: translate(-50%, -50%) scale(1);
      }
      to {
        opacity: 0;
        transform: translate(-50%, -60%) scale(0.9);
      }
    }

    .mini-event-content {
      display: flex;
      align-items: center;
      gap: 15px;
      padding: 20px 25px;
      border-radius: 16px;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
      max-width: 350px;
    }

    .mini-event-popup.positive .mini-event-content {
      background: linear-gradient(135deg, var(--bg-card) 0%, rgba(107, 203, 119, 0.2) 100%);
      border: 3px solid var(--success);
    }

    .mini-event-popup.negative .mini-event-content {
      background: linear-gradient(135deg, var(--bg-card) 0%, rgba(255, 107, 107, 0.2) 100%);
      border: 3px solid var(--danger);
    }

    .mini-event-popup.neutral .mini-event-content {
      background: linear-gradient(135deg, var(--bg-card) 0%, rgba(77, 150, 255, 0.2) 100%);
      border: 3px solid var(--info);
    }

    .mini-event-icon {
      font-size: 2.5rem;
      animation: miniEventBounce 0.5s ease-in-out;
    }

    @keyframes miniEventBounce {
      0%, 100% { transform: scale(1); }
      30% { transform: scale(1.3); }
      60% { transform: scale(0.9); }
    }

    .mini-event-info {
      flex: 1;
    }

    .mini-event-name {
      font-size: 1.1rem;
      font-weight: bold;
      margin-bottom: 5px;
    }

    .mini-event-desc {
      font-size: 0.85rem;
      color: var(--text-muted);
      margin-bottom: 8px;
      line-height: 1.4;
    }

    .mini-event-result {
      font-size: 0.9rem;
      font-weight: bold;
    }

    .mini-event-popup.positive .mini-event-result {
      color: var(--success);
    }

    .mini-event-popup.negative .mini-event-result {
      color: var(--danger);
    }

    .mini-event-popup.neutral .mini-event-result {
      color: var(--text-muted);
    }

    /* ===== å»ºç¯‰å‡ç´šç³»çµ± ===== */

    /* å‡ç´šæŒ‰éˆ• */
    .upgrade-btn {
      width: 50px;
      height: 50px;
      border-radius: 50%;
      background: linear-gradient(135deg, #22c55e 0%, #10b981 100%);
      border: none;
      font-size: 1.3rem;
      cursor: pointer;
      box-shadow: 0 4px 12px rgba(34, 197, 94, 0.4);
      display: flex;
      align-items: center;
      justify-content: center;
      transition: transform 0.2s;
    }

    .upgrade-btn:hover {
      transform: scale(1.1);
    }

    /* å‡ç´š Modal */
    #upgrade-modal {
      display: none;
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.5);
      z-index: 300;
      padding: 20px;
      overflow-y: auto;
      backdrop-filter: blur(4px);
    }

    #upgrade-modal.show {
      display: block;
    }

    .upgrade-modal-content {
      background: var(--bg-card);
      border-radius: 24px;
      max-width: 450px;
      margin: 0 auto;
      padding: 20px;
      box-shadow: 0 8px 32px rgba(0,0,0,0.2);
    }

    .upgrade-modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }

    .upgrade-modal-title {
      font-size: 1.3rem;
      font-weight: bold;
    }

    .upgrade-modal-close {
      background: none;
      border: none;
      color: var(--text-muted);
      font-size: 1.5rem;
      cursor: pointer;
    }

    .no-upgrades {
      text-align: center;
      padding: 40px 20px;
      color: var(--text-muted);
    }

    .no-upgrades-icon {
      font-size: 3rem;
      margin-bottom: 15px;
    }

    .no-upgrades-text {
      font-size: 1.1rem;
      margin-bottom: 10px;
    }

    .no-upgrades-hint {
      font-size: 0.9rem;
      color: var(--text-muted);
    }

    .upgrade-card {
      background: rgba(255,255,255,0.8);
      border: 3px solid var(--success);
      border-radius: 20px;
      padding: 20px;
      margin-bottom: 15px;
      cursor: pointer;
      transition: all 0.2s;
    }

    .upgrade-card:hover {
      transform: translateY(-3px);
      box-shadow: 0 8px 24px rgba(107, 203, 119, 0.4);
    }

    .upgrade-from, .upgrade-to {
      text-align: center;
    }

    .upgrade-building-icon {
      font-size: 2.5rem;
      margin-bottom: 5px;
    }

    .upgrade-building-name {
      font-weight: bold;
      margin-bottom: 5px;
    }

    .upgrade-building-count {
      font-size: 0.85rem;
      color: var(--text-muted);
    }

    .upgrade-arrow {
      display: flex;
      flex-direction: column;
      align-items: center;
      margin: 15px 0;
    }

    .upgrade-merge {
      background: var(--primary);
      color: white;
      padding: 4px 12px;
      border-radius: 12px;
      font-size: 0.85rem;
      font-weight: bold;
      margin-bottom: 5px;
    }

    .upgrade-arrow-icon {
      font-size: 1.5rem;
      color: var(--success);
    }

    .upgrade-bonus {
      color: var(--success);
      font-weight: bold;
      font-size: 1.1rem;
    }

    .upgrade-times {
      text-align: center;
      margin-top: 10px;
      font-size: 0.85rem;
      color: var(--primary);
      font-weight: bold;
    }

    /* å‡ç´šå‹•ç•«å½ˆå‡º */
    .upgrade-animation-popup {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      z-index: 1004;
      animation: upgradePopIn 0.5s ease-out;
    }

    .upgrade-animation-popup.fade-out {
      animation: upgradePopOut 0.5s ease-in forwards;
    }

    @keyframes upgradePopIn {
      from {
        opacity: 0;
        transform: translate(-50%, -50%) scale(0.5);
      }
      to {
        opacity: 1;
        transform: translate(-50%, -50%) scale(1);
      }
    }

    @keyframes upgradePopOut {
      from {
        opacity: 1;
        transform: translate(-50%, -50%) scale(1);
      }
      to {
        opacity: 0;
        transform: translate(-50%, -50%) scale(0.5);
      }
    }

    .upgrade-animation-content {
      background: linear-gradient(135deg, var(--bg-card) 0%, rgba(107, 203, 119, 0.3) 100%);
      border: 4px solid var(--success);
      border-radius: 28px;
      padding: 30px 50px;
      text-align: center;
      box-shadow: 0 0 50px rgba(107, 203, 119, 0.5);
    }

    .upgrade-animation-from {
      font-size: 2rem;
      margin-bottom: 10px;
      animation: upgradeShake 0.3s ease-in-out;
    }

    @keyframes upgradeShake {
      0%, 100% { transform: translateX(0); }
      25% { transform: translateX(-5px); }
      75% { transform: translateX(5px); }
    }

    .upgrade-animation-arrow {
      font-size: 2rem;
      margin: 10px 0;
      animation: upgradeArrowBounce 0.5s ease-in-out 0.2s;
    }

    @keyframes upgradeArrowBounce {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(10px); }
    }

    .upgrade-animation-to {
      font-size: 4rem;
      animation: upgradeNewBuilding 0.6s ease-out 0.4s both;
    }

    @keyframes upgradeNewBuilding {
      from {
        transform: scale(0);
        opacity: 0;
      }
      to {
        transform: scale(1);
        opacity: 1;
      }
    }

    .upgrade-animation-bonus {
      margin-top: 15px;
      font-size: 1.5rem;
      font-weight: bold;
      color: var(--success);
      animation: upgradeBonusPulse 0.5s ease-in-out 0.8s both;
    }

    @keyframes upgradeBonusPulse {
      from { transform: scale(0); }
      50% { transform: scale(1.2); }
      to { transform: scale(1); }
    }

    /* ===== é™æ™‚æ¶è³¼ç³»çµ± ===== */

    .flash-sale-banner {
      position: fixed;
      top: 80px;
      left: 50%;
      transform: translateX(-50%) translateY(-120%);
      z-index: 500;
      width: calc(100% - 40px);
      max-width: 400px;
      transition: transform 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
    }

    .flash-sale-banner.show {
      transform: translateX(-50%) translateY(0);
    }

    .flash-sale-content {
      background: linear-gradient(135deg, #ffffff 0%, #ffe5e5 100%);
      border: 3px solid var(--danger);
      border-radius: 24px;
      padding: 20px;
      box-shadow: 0 8px 32px rgba(255, 107, 107, 0.4);
      animation: flashSalePulse 2s ease-in-out infinite;
    }

    @keyframes flashSalePulse {
      0%, 100% { box-shadow: 0 8px 32px rgba(239, 68, 68, 0.4); }
      50% { box-shadow: 0 8px 48px rgba(239, 68, 68, 0.6); }
    }

    .flash-sale-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
    }

    .flash-sale-label {
      font-size: 1rem;
      font-weight: bold;
      color: #ef4444;
      animation: flashSaleLabelBlink 0.5s ease-in-out infinite alternate;
    }

    @keyframes flashSaleLabelBlink {
      from { opacity: 0.7; }
      to { opacity: 1; }
    }

    .flash-sale-timer {
      font-size: 1.2rem;
      font-weight: bold;
      color: #FF9800;
      background: rgba(255,255,255,0.9);
      padding: 5px 12px;
      border-radius: 12px;
      border: 2px solid var(--border);
    }

    .flash-sale-timer.urgent {
      color: #ef4444;
      animation: timerUrgent 0.3s ease-in-out infinite alternate;
    }

    @keyframes timerUrgent {
      from { transform: scale(1); }
      to { transform: scale(1.1); }
    }

    .flash-sale-item {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      margin-bottom: 10px;
    }

    .flash-sale-icon {
      font-size: 2.5rem;
      animation: flashItemBounce 1s ease-in-out infinite;
    }

    @keyframes flashItemBounce {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-5px); }
    }

    .flash-sale-name {
      font-size: 1.3rem;
      font-weight: bold;
    }

    .flash-sale-price {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      margin-bottom: 10px;
    }

    .flash-sale-original {
      text-decoration: line-through;
      color: var(--text-muted);
      font-size: 0.9rem;
    }

    .flash-sale-discount {
      font-size: 1.5rem;
      font-weight: bold;
      color: var(--success);
    }

    .flash-sale-off {
      background: #ef4444;
      color: white;
      padding: 4px 10px;
      border-radius: 8px;
      font-size: 0.9rem;
      font-weight: bold;
    }

    .flash-sale-remaining {
      text-align: center;
      margin-bottom: 15px;
      font-size: 0.95rem;
      color: var(--text-muted);
    }

    .flash-sale-remaining span {
      color: var(--warning);
      font-weight: bold;
      font-size: 1.2rem;
    }

    .flash-sale-btn {
      width: 100%;
      padding: 15px;
      border: none;
      border-radius: 14px;
      font-size: 1.2rem;
      font-weight: bold;
      cursor: pointer;
      background: linear-gradient(135deg, var(--danger) 0%, #E53935 100%);
      color: white;
      transition: all 0.2s;
      animation: flashBtnPulse 1s ease-in-out infinite;
      box-shadow: 0 4px 16px rgba(255, 107, 107, 0.4);
    }

    @keyframes flashBtnPulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.02); }
    }

    .flash-sale-btn:hover {
      background: linear-gradient(135deg, #E53935 0%, #C62828 100%);
      box-shadow: 0 6px 20px rgba(255, 107, 107, 0.5);
    }

    .flash-sale-btn.disabled {
      background: var(--border);
      cursor: not-allowed;
      animation: none;
      box-shadow: none;
    }

    /* ç™»å…¥ç•«é¢éš±è—éŠæˆ²åŠŸèƒ½æŒ‰éˆ• */
    .achievements-btn,
    .item-buttons {
      display: none;
    }

    /* åªæœ‰éŠæˆ²ç•«é¢é¡¯ç¤ºæ™‚æ‰é¡¯ç¤ºé€™äº›æŒ‰éˆ• */
    .game-active .achievements-btn {
      display: flex;
    }

    .game-active .item-buttons {
      display: flex;
    }
  </style>
</head>
<body>
  <!-- è¼‰å…¥ç•«é¢ -->
  <div id="loading-screen">
    <div class="loading-spinner"></div>
    <p style="margin-top: 20px;">é€£ç·šä¸­...</p>
  </div>

  <!-- åŠ å…¥éŠæˆ²ç•«é¢ -->
  <div id="join-screen">
    <div class="join-wrapper">
      <img src="https://firebasestorage.googleapis.com/v0/b/christmas-tree-3fe6b.firebasestorage.app/o/logo%2F%E8%B3%87%E7%94%A2%2072.png?alt=media&token=54bd80ed-9c24-48fc-8a11-19aa95542d13" alt="å‰µæ™ºå‹•èƒ½" class="company-logo">
      <div class="game-logo">ğŸ™ï¸</div>
      <div class="join-container">
        <h1 class="game-title">å‰µæ™ºå‹•èƒ½ 2026</h1>
        <p class="game-subtitle">ğŸ—ï¸ æ”œæ‰‹å…±å»ºãƒ»å‰µé€ å¥‡è¹Ÿ ğŸŒŸ</p>

        <form id="join-form">
          <div class="input-group">
            <label for="player-name">ä½ çš„åå­—</label>
            <input type="text" id="player-name" placeholder="è«‹è¼¸å…¥åå­—" required maxlength="20">
          </div>
          <div class="input-group">
            <label for="player-password">å¯†ç¢¼ï¼ˆ4-8ä½æ•¸å­—æˆ–å­—æ¯ï¼‰</label>
            <input type="password" id="player-password" placeholder="è«‹è¨­å®šå¯†ç¢¼" required minlength="4" maxlength="8" pattern="[a-zA-Z0-9]+">
            <small style="display: block; margin-top: 5px; color: #666; font-size: 0.85rem;">ğŸ’¡ åŒåå­—+åŒå¯†ç¢¼å¯åœ¨ä¸åŒè£ç½®ç™»å…¥</small>
          </div>
          <button type="submit" class="btn btn-primary" id="join-btn">åŠ å…¥éŠæˆ²</button>
        </form>
      </div>
    </div>
  </div>

  <!-- éŠæˆ²ä¸»ç•«é¢ -->
  <div id="game-screen">
    <!-- é ‚éƒ¨ç‹€æ…‹æ¬„ -->
    <div class="game-header">
      <div class="header-top">
        <div class="player-name-display" id="player-name-display">ç©å®¶</div>
        <div class="header-role-badge" id="header-role-badge" onclick="openRoleModal()" style="display: none;">
          <span class="header-role-emoji" id="header-role-emoji"></span>
          <span class="header-role-name" id="header-role-name"></span>
        </div>
      </div>
      <div class="resources">
        <div class="resource-item">
          <div class="resource-icon">ğŸ’°</div>
          <div>
            <div class="resource-value" id="res-coins">500</div>
            <div class="resource-label">é‡‘å¹£</div>
          </div>
        </div>
        <div class="resource-item">
          <div class="resource-icon">â­</div>
          <div>
            <div class="resource-value" id="res-score">0</div>
            <div class="resource-label">ç¸½ç©åˆ†</div>
          </div>
        </div>
      </div>
    </div>

    <!-- ç­‰å¾…é–‹å§‹ -->
    <div class="waiting-screen show" id="waiting-screen">
      <div class="waiting-emoji">ğŸ—ï¸</div>
      <div class="waiting-text">ç­‰å¾…éŠæˆ²é–‹å§‹</div>
      <div class="player-count">ç›®å‰ <span id="player-count">0</span> ä½ç©å®¶</div>
      <p style="margin-top: 20px; color: var(--text-muted); font-size: 0.9rem;">
        é½Šå¿ƒå”åŠ›ï¼Œæ‰“é€ å‰µæ™ºå‹•èƒ½çš„å®Œç¾åŸå¸‚ï¼
      </p>
    </div>

    <!-- éŠæˆ²å…§å®¹ -->
    <div class="game-content" id="game-content" style="display: none;">
      <!-- äº‹ä»¶é¡¯ç¤º -->
      <div class="event-display" id="event-display" onclick="hideEventDisplay()">
        <button class="event-close-btn" onclick="event.stopPropagation(); hideEventDisplay();">âœ•</button>
        <div class="event-emoji" id="event-emoji"></div>
        <div class="event-title" id="event-title"></div>
        <div class="event-description" id="event-description"></div>
        <div class="event-effects" id="event-effects"></div>
        <div class="income-result" id="income-result">
          <div>æœ¬æ¬¡ç‡Ÿæ”¶ï¼ˆé‡‘å¹£ï¼‹ç¸½ç©åˆ†ï¼‰</div>
          <div class="income-amount" id="income-amount">+0</div>
        </div>
        <div class="event-dismiss-hint">é»æ“Šä»»æ„è™•é—œé–‰ï¼Œç¹¼çºŒå»ºé€ </div>
      </div>

      <!-- æˆ‘çš„å»ºç¯‰ -->
      <div class="my-buildings">
        <div class="my-buildings-title">ğŸ  æˆ‘çš„å»ºç¯‰</div>
        <div class="my-buildings-grid" id="my-buildings-grid">
          <div class="no-buildings">å°šæœªå»ºé€ ä»»ä½•å»ºç¯‰</div>
        </div>
      </div>

      <!-- å»ºç¯‰é¸æ“‡å€ -->
      <div class="building-section" id="building-section">
        <h3 class="section-title">ğŸ—ï¸ å»ºé€ å»ºç¯‰</h3>
        <div class="category-tabs" id="category-tabs">
          <!-- å‹•æ…‹ç”Ÿæˆ -->
        </div>
        <div class="building-grid" id="building-grid">
          <!-- å‹•æ…‹ç”Ÿæˆ -->
        </div>
      </div>

      <!-- æ’è¡Œæ¦œ -->
      <div class="leaderboard">
        <div class="leaderboard-title">ğŸ† æ’è¡Œæ¦œ</div>
        <ul class="leaderboard-list" id="leaderboard-list">
          <!-- å‹•æ…‹ç”Ÿæˆ -->
        </ul>
      </div>
    </div>

    <!-- çµæœç•«é¢ -->
    <div class="result-screen" id="result-screen">
      <div class="result-card">
        <div class="result-label">ä½ çš„ç¸½ç©åˆ†</div>
        <div class="result-score" id="final-score">0</div>
      </div>
      <div class="result-card">
        <div class="result-label">ä½ çš„æŠ½çæ©Ÿæœƒ</div>
        <div class="result-score" id="lottery-tier">???</div>
      </div>
      <div class="leaderboard">
        <div class="leaderboard-title">ğŸ† æœ€çµ‚æ’è¡Œæ¦œ</div>
        <ul class="leaderboard-list" id="final-leaderboard">
          <!-- å‹•æ…‹ç”Ÿæˆ -->
        </ul>
      </div>
    </div>
  </div>

  <!-- æˆå°±æŒ‰éˆ• -->
  <button class="achievements-btn" onclick="openAchievementsModal()" title="æˆå°±" id="achievements-btn" style="display: none;">
    ğŸ†
    <span class="badge" id="achievement-count">0/0</span>
  </button>

  <!-- é“å…·æŒ‰éˆ•çµ„ -->
  <div class="item-buttons" id="item-buttons" style="display: none;">
    <button class="item-btn shop" onclick="openItemShopModal()" title="é“å…·å•†åº—">
      ğŸ›’
    </button>
    <button class="item-btn backpack" onclick="openMyItemsModal()" title="æˆ‘çš„é“å…·">
      ğŸ’
      <span class="badge" id="item-count">0</span>
    </button>
    <button class="upgrade-btn" onclick="openUpgradeModal()" title="å»ºç¯‰å‡ç´š">
      â¬†ï¸
    </button>
  </div>

  <!-- é“å…·å•†åº— Modal -->
  <div id="item-shop-modal">
    <div class="item-modal-content">
      <div class="item-modal-header">
        <div class="item-modal-title">ğŸ›’ é“å…·å•†åº—</div>
        <button class="item-modal-close" onclick="closeItemShopModal()">&times;</button>
      </div>
      <div class="item-modal-coins" id="shop-coins">ğŸ’° <span id="shop-coins-value">0</span></div>
      <div id="item-shop-list">
        <!-- å‹•æ…‹ç”Ÿæˆ -->
      </div>
    </div>
  </div>

  <!-- æˆ‘çš„é“å…· Modal -->
  <div id="my-items-modal">
    <div class="item-modal-content">
      <div class="item-modal-header">
        <div class="item-modal-title">ğŸ’ æˆ‘çš„é“å…·</div>
        <button class="item-modal-close" onclick="closeMyItemsModal()">&times;</button>
      </div>
      <div id="my-items-list">
        <div style="text-align: center; color: var(--text-muted); padding: 20px;">
          è¼‰å…¥ä¸­...
        </div>
      </div>
    </div>
  </div>

  <!-- æˆå°±åˆ—è¡¨ Modal -->
  <div id="achievements-modal">
    <div class="achievements-modal-content">
      <div class="achievements-modal-header">
        <div class="achievements-modal-title">ğŸ† æˆå°±</div>
        <button class="achievements-modal-close" onclick="closeAchievementsModal()">&times;</button>
      </div>
      <div id="achievements-list">
        <!-- å‹•æ…‹ç”Ÿæˆ -->
        <div style="text-align: center; color: var(--text-muted); padding: 20px;">
          è¼‰å…¥ä¸­...
        </div>
      </div>
    </div>
  </div>

  <!-- å»ºç¯‰å‡ç´š Modal -->
  <div id="upgrade-modal">
    <div class="upgrade-modal-content">
      <div class="upgrade-modal-header">
        <div class="upgrade-modal-title">â¬†ï¸ å»ºç¯‰å‡ç´š</div>
        <button class="upgrade-modal-close" onclick="closeUpgradeModal()">&times;</button>
      </div>
      <div id="upgrade-list">
        <!-- å‹•æ…‹ç”Ÿæˆ -->
        <div class="no-upgrades">
          <div class="no-upgrades-icon">ğŸ—ï¸</div>
          <div class="no-upgrades-text">è¼‰å…¥ä¸­...</div>
        </div>
      </div>
    </div>
  </div>

  <!-- è§’è‰² Modal -->
  <div id="role-modal">
    <div class="role-modal-content" style="position: relative;">
      <button class="role-modal-close" onclick="closeRoleModal()">&times;</button>
      <div id="role-modal-body">
        <!-- å‹•æ…‹ç”Ÿæˆ -->
        <div style="text-align: center; color: var(--text-muted); padding: 20px;">
          è¼‰å…¥ä¸­...
        </div>
      </div>
    </div>
  </div>

  <!-- è³¼è²·ç¢ºèªå½ˆçª— -->
  <div class="modal-overlay" id="buy-modal">
    <div class="modal">
      <div class="modal-emoji" id="modal-emoji">ğŸ </div>
      <div class="modal-title" id="modal-title">å»ºé€ å»ºç¯‰</div>
      <div class="modal-info">
        <div class="modal-info-row">
          <span>å»ºé€ è²»ç”¨</span>
          <span id="modal-cost">ğŸ’° 100</span>
        </div>
        <div class="modal-info-row">
          <span>æ¯å›åˆç‡Ÿæ”¶</span>
          <span id="modal-income">â­ +15åˆ†</span>
        </div>
        <div class="modal-info-row">
          <span>å»ºé€ å¾Œé¤˜é¡</span>
          <span id="modal-remaining">ğŸ’° 400</span>
        </div>
      </div>
      <div class="modal-buttons">
        <button class="modal-btn cancel" onclick="closeBuyModal()">å–æ¶ˆ</button>
        <button class="modal-btn confirm" id="modal-confirm-btn" onclick="confirmBuy()">ç¢ºèªå»ºé€ </button>
      </div>
    </div>
  </div>

  <!-- å¿«å•å¿«ç­” Modal -->
  <div class="modal-overlay" id="quiz-modal">
    <div class="modal" style="max-width: 500px;">
      <div class="modal-title" id="quiz-question-text" style="font-size: 1.2rem; margin-bottom: 20px;">å•é¡Œè¼‰å…¥ä¸­...</div>
      <div id="quiz-options" style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
        <!-- å‹•æ…‹ç”Ÿæˆ -->
      </div>
      <div style="text-align: center; margin-top: 15px; font-size: 0.85rem; color: var(--text-muted);">
        <span id="quiz-progress">é¡Œè™Ÿ</span> | å‰©é¤˜æ™‚é–“: <span id="quiz-timer" style="color: var(--danger); font-weight: bold;">3s</span>
      </div>
    </div>
  </div>

  <!-- å–å•¤é…’æ¯”è³½åŠ å…¥ Modal -->
  <div class="modal-overlay" id="beer-join-modal">
    <div class="modal">
      <div class="modal-emoji">ğŸº</div>
      <div class="modal-title">å–å•¤é…’æ¯”è³½</div>
      <div class="modal-info" style="text-align: center;">
        <p style="margin-bottom: 10px;">æ¯å±€æœ€å¤š5äººåƒåŠ </p>
        <p style="font-size: 0.9rem; color: var(--text-muted);">ç¬¬1å +500åˆ† | ç¬¬2å +300åˆ† | å…¶ä»– +100åˆ†</p>
      </div>
      <div class="modal-buttons">
        <button class="modal-btn cancel" onclick="closeBeerJoinModal()">å–æ¶ˆ</button>
        <button class="modal-btn confirm" onclick="joinBeerGame()">æˆ‘è¦åƒåŠ </button>
      </div>
    </div>
  </div>

  <!-- å¿«å•å¿«ç­”çµæœ Modal -->
  <div class="modal-overlay" id="quiz-result-modal">
    <div class="modal" style="max-width: 600px; max-height: 80vh; overflow-y: auto;">
      <div class="modal-emoji">ğŸ’¡</div>
      <div class="modal-title">å¿«å•å¿«ç­”çµæœ</div>
      <div class="modal-info" style="text-align: center; margin-bottom: 20px;">
        <div style="font-size: 1.5rem; font-weight: bold; color: var(--success);">
          ç­”å° <span id="quiz-result-correct">0</span> / <span id="quiz-result-total">10</span> é¡Œ
        </div>
        <div style="font-size: 1.1rem; margin-top: 10px; color: var(--warning);">
          ç²å¾— <span id="quiz-result-reward">0</span> é‡‘å¹£å’Œç©åˆ† â­
        </div>
      </div>
      <div id="quiz-result-details" style="text-align: left; padding: 10px;">
        <!-- å‹•æ…‹ç”Ÿæˆé¡Œç›®å’Œç­”æ¡ˆ -->
      </div>
      <div class="modal-buttons">
        <button class="modal-btn confirm" onclick="closeQuizResultModal()">ç¢ºå®š</button>
      </div>
    </div>
  </div>

  <!-- æ¯”å¤§å°ä¸‹æ³¨ Modal -->
  <div class="modal-overlay" id="poker-bet-modal">
    <div class="modal">
      <div class="modal-emoji">ğŸƒ</div>
      <div class="modal-title">æ¯”å¤§å°</div>
      <div class="modal-info" style="text-align: center;">
        <p style="margin-bottom: 10px;">çŒœæ¸¬æ’²å…‹ç‰Œæ˜¯å¤§é‚„æ˜¯å°ï¼Ÿ</p>
        <p style="font-size: 0.85rem; color: var(--text-muted);">7~K = å¤§ | A~6 = å°</p>
        <p style="font-size: 0.85rem; color: var(--success); margin-top: 5px;">çŒœå° +100åˆ† | çŒœéŒ¯è¦å–é…’</p>
      </div>
      <div style="text-align: center; margin: 15px 0; font-size: 0.9rem; color: var(--warning);">
        å€’æ•¸ï¼š<span id="poker-countdown" style="font-weight: bold; font-size: 1.2rem;">20s</span>
      </div>
      <div class="modal-buttons">
        <button class="modal-btn" style="flex: 1; background: var(--danger); color: white;" onclick="placeBet('small')">
          å£“å° (A~6)
        </button>
        <button class="modal-btn" style="flex: 1; background: var(--success); color: white;" onclick="placeBet('big')">
          å£“å¤§ (7~K)
        </button>
      </div>
    </div>
  </div>

  <!-- çŒœæ­Œæ›²å‰å¥ Modal -->
  <div class="modal-overlay" id="song-guess-modal">
    <div class="modal">
      <div class="modal-emoji">ğŸµ</div>
      <div class="modal-title">çŒœæ­Œæ›²å‰å¥</div>
      <div class="modal-info" style="text-align: center;">
        <p style="margin-bottom: 15px;">è«‹è¼¸å…¥ä½ çŒœæ¸¬çš„æ­Œå</p>
      </div>
      <input type="text" id="song-guess-input" class="form-control" placeholder="è¼¸å…¥æ­Œå..." style="margin-bottom: 15px; padding: 12px; font-size: 1rem; border: 2px solid var(--primary); border-radius: 8px; text-align: center;">
      <div class="modal-buttons">
        <button class="modal-btn" style="background: var(--success); color: white;" onclick="submitSongGuess()">
          âœ“ ç¢ºèªé€å‡º
        </button>
      </div>
      <div id="song-identifying" style="display: none; text-align: center; margin-top: 15px;">
        <div style="font-size: 1.1rem; color: var(--warning); font-weight: bold; animation: pulse 1.5s infinite;">
          è­˜åˆ¥ä¸­...
        </div>
        <div style="margin-top: 10px; font-size: 0.85rem; color: var(--text-muted);">
          ç­‰å¾…ä¸»æŒäººå…¬å¸ƒçµæœ
        </div>
      </div>
    </div>
  </div>

  <!-- çŒœæ­Œçµæœ Modal -->
  <div class="modal-overlay" id="song-result-modal">
    <div class="modal">
      <div class="modal-emoji" id="song-result-emoji">ğŸ‰</div>
      <div class="modal-title" id="song-result-title">çµæœ</div>
      <div class="modal-info" style="text-align: center;">
        <p id="song-result-message" style="font-size: 1.2rem; font-weight: bold; margin-bottom: 10px;"></p>
        <p id="song-result-detail" style="font-size: 0.9rem; color: var(--text-muted);"></p>
      </div>
      <div class="modal-buttons">
        <button class="modal-btn" style="background: var(--primary); color: white;" onclick="closeSongResult()">
          ç¢ºå®š
        </button>
      </div>
    </div>
  </div>

  <!-- Socket.IO -->
  <script src="/socket.io/socket.io.js"></script>
  <script src="./client/player.js"></script>
</body>
</html>
